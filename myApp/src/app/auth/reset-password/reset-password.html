<div class="reset-password-container">
  <h2 class="title">Reset Password</h2>

  <p class="info-text">
    A verification code was sent to <strong>{{ email }}</strong>
  </p>

  <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
    <!-- Email (Hidden) -->
    <input type="hidden" formControlName="email" [value]="email" />

    <!-- Code -->
    <div class="form-group">
      <label for="code">Verification Code</label>
      <input
        id="code"
        type="text"
        maxlength="6"
        formControlName="code"
        class="form-control"
        placeholder="Enter 6-digit code"
      />
      <div
        *ngIf="resetPasswordForm.get('code')?.touched && resetPasswordForm.get('code')?.invalid"
        class="error"
      >
        <small *ngIf="resetPasswordForm.get('code')?.errors?.['required']">Code is required</small>
        <small
          *ngIf="resetPasswordForm.get('code')?.errors?.['minlength'] || resetPasswordForm.get('code')?.errors?.['maxlength']"
        >
          Code must be 6 digits
        </small>
        <small *ngIf="resetPasswordForm.get('code')?.errors?.['pattern']"
          >Only numbers allowed</small
        >
      </div>
    </div>

    <!-- New Password -->
    <div class="form-group">
      <label for="newPassword">New Password</label>
      <input
        id="newPassword"
        type="password"
        formControlName="newPassword"
        class="form-control"
        placeholder="Enter new password"
      />
      <div
        *ngIf="
          resetPasswordForm.get('newPassword')?.touched &&
          resetPasswordForm.get('newPassword')?.invalid
        "
        class="error"
      >
        <small *ngIf="resetPasswordForm.get('newPassword')?.errors?.['required']"
          >Password is required</small
        >
        <small *ngIf="resetPasswordForm.get('newPassword')?.errors?.['minlength']"
          >Password must be at least 8 characters</small
        >
      </div>
    </div>

    <!-- Confirm Password -->
    <div class="form-group">
      <label for="confirmPassword">Confirm Password</label>
      <input
        id="confirmPassword"
        type="password"
        formControlName="confirmPassword"
        class="form-control"
        placeholder="Confirm new password"
      />
      <div
        *ngIf="
          resetPasswordForm.get('confirmPassword')?.touched &&
          resetPasswordForm.get('confirmPassword')?.invalid
        "
        class="error"
      >
        <small *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']"
          >Confirm Password is required</small
        >
      </div>

      <!-- Custom Validator Error (Password mismatch) -->
      <div
        *ngIf="resetPasswordForm.errors?.['mismatch'] && resetPasswordForm.get('confirmPassword')?.touched"
        class="error"
      >
        <small>Passwords do not match</small>
      </div>
    </div>

    <!-- Error Message from API -->
    <div *ngIf="msg" class="error-msg">
      {{ msg }}
    </div>

    <!-- Submit -->
    <button type="submit" class="btn" [disabled]="resetPasswordForm.invalid">Reset Password</button>
  </form>
</div>
